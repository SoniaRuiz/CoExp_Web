using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;
using CoExp_Web.Models;
using CoExp_Web.Repositories;
using Microsoft.AspNetCore.Hosting;
using Microsoft.AspNetCore.Http;
using Microsoft.AspNetCore.Mvc;
using Newtonsoft.Json;
using Newtonsoft.Json.Linq;


namespace CoExp_Web.Controllers
{
    /// <summary>
    /// API controller (does not return a view) to obtain information from different web services
    /// </summary>
    [Route("[controller]")]
    [ApiController]
    public class APIController : ControllerBase
    {
        private readonly IHostingEnvironment _hostingEnvironment;

        public APIController(IHostingEnvironment hostingEnvironment)
        {
            _hostingEnvironment = hostingEnvironment;
        }
        /****************************************************************************/
        /******************************* GET METHODS *******************************/
        /****************************************************************************/

        /// <summary>
        /// Welcome method. Used as a tester.
        /// </summary>
        /// <returns>Welcome string</returns>
        [HttpGet]
        public string Index()
        {
            return "Welcome!";
        }

        [HttpGet]
        [Route("GetNetworkCategories")]
        public string GetNetworkCategories()
        {
            //getNetworkCategories()
            CoExpRepository repository = new CoExpRepository(_hostingEnvironment);
            string response = repository.GetNetworkCategories();
            return response;
        }

        [HttpGet]
        [Route("GetAvailableNetworks")]
        public string GetAvailableNetworks([FromQuery] CoexpParams coexpdata)
        {
            CoExpRepository repository = new CoExpRepository(_hostingEnvironment);
            string response = repository.GetAvailableNetworks(coexpdata);
            return response;
        }

        [HttpGet]
        [Route("GetGOFromTissue")]
        public string GetGOFromTissue([FromQuery] CoexpParams coexpdata)
        {
            //category = which.one
            //network = tissue
            CoExpRepository repository = new CoExpRepository(_hostingEnvironment);
            string response = repository.GetGOFromTissue(coexpdata);
            
            //REPLACE CHARACTERS
            string parsed_response = response.Replace("query.number", "query_number");
            parsed_response = parsed_response.Replace("p.value", "p_value");
            parsed_response = parsed_response.Replace("term.size", "term_size");
            parsed_response = parsed_response.Replace("query.size", "query_size");
            parsed_response = parsed_response.Replace("overlap.size", "overlap_size");
            parsed_response = parsed_response.Replace("term.id", "term_id");
            parsed_response = parsed_response.Replace("subgraph.number", "subgraph_number");
            parsed_response = parsed_response.Replace("term.name", "term_name");
            parsed_response = parsed_response.Replace("relative.depth", "relative_depth");
            parsed_response = parsed_response.Replace(",", ", ");

            return parsed_response;
        }

        [HttpGet]
        [Route("GetCellTypeFromTissue")]
        public string GetCellTypeFromTissue([FromQuery] CoexpParams coexpdata)
        {
            CoExpRepository repository = new CoExpRepository(_hostingEnvironment);
            string response = repository.GetCellTypeFromTissue(coexpdata);
            return response;
        }

        [HttpGet]
        [Route("GetTreeMenuData")]
        public string GetTreeMenuData()
        {
            try
            {
                dynamic jsonCategories = JsonConvert.DeserializeObject(GetNetworkCategories());
                List<TreeMenuNode> nodes = new List<TreeMenuNode>();
                //List<Network> networks = new List<Network>();
                int categoryID = 1;
                int networkID = 100;

                TreeMenuNode all = new TreeMenuNode();
                all.name = "All";
                all.id = "0";
                all.pid = string.Empty;
                nodes.Add(all);

                foreach (var categoryName in jsonCategories)
                {
                    TreeMenuNode category = new TreeMenuNode();
                    category.name = categoryName;
                    category.id = categoryID.ToString();
                    category.pid = "0";
                    category.label = categoryName;
                    nodes.Add(category);

                    CoexpParams coexpParams = new CoexpParams();
                    coexpParams.Category = category.name;


                    dynamic jsonNetworks = JsonConvert.DeserializeObject(GetAvailableNetworks(coexpParams));
                    foreach (var networkName in jsonNetworks)
                    {
                        TreeMenuNode network = new TreeMenuNode();
                        network.name = networkName;
                        network.id = networkID.ToString();
                        network.pid = categoryID.ToString();
                        network.label = categoryName;

                        nodes.Add(network);
                        networkID++;

                    }



                    categoryID++;
                    networkID = 100;
                }
                var jsonAllData = JsonConvert.SerializeObject(nodes);
                return jsonAllData;
            }
            catch(Exception ex)
            {
                return "Problems with web service connection. " + ex.Message;
            }

        }

        [HttpGet]
        [Route("GetTomDataBRAINEAC")]
        public string GetTomDataBRAINEAC([FromQuery] BraineacParams braineacData)
        {
            BraineacRepository repository = new BraineacRepository();
            //string response = repository.GetJSONTomData(braineacData);
            string response = "{\"columns\": [\"gene\", \"ensg\", \"module\", \"ENSG00000187231\", \"ENSG00000151240\", \"ENSG00000234531\", \"ENSG00000131386\", \"ENSG00000270405\", \"ENSG00000249772\", \"ENSG00000159256\", \"ENSG00000188486\", \"ENSG00000100221\", \"ENSG00000271468\", \"ENSG00000012048\", \"ENSG00000130684\", \"ENSG00000164989\", \"ENSG00000230409\", \"ENSG00000179468\", \"ENSG00000143995\", \"ENSG00000169918\", \"ENSG00000248466\", \"ENSG00000225215\", \"ENSG00000132911\", \"ENSG00000039560\", \"ENSG00000189423\", \"ENSG00000239528\", \"ENSG00000233757\", \"ENSG00000198718\", \"ENSG00000112893\", \"ENSG00000234017\", \"ENSG00000253697\", \"ENSG00000102871\", \"ENSG00000253042\"], \"results\": [[\"SESTD1\", \"ENSG00000187231\", \"black\", 1.0, 0.025687040761113167, 0.009459679014980793, 0.02879427932202816, 0.008128294721245766, 0.0007437103195115924, 0.03078741766512394, 0.025316674262285233, 0.026060927659273148, 0.005704238545149565, 0.03298395127058029, 0.025317203253507614, 0.015101919881999493, 0.0012175124138593674, 0.023385992273688316, 0.025865348055958748, 0.022621192038059235, 0.007499865256249905, 0.009280161932110786, 0.02548004686832428, 0.03793855383992195, 0.0008499817922711372, 0.015152987092733383, 0.0035728802904486656, 0.0010776659473776817, 0.03232298046350479, 0.000769569247495383, 0.01177567895501852, 0.020415619015693665, 0.008788551203906536], [\"DIP2C\", \"ENSG00000151240\", \"black\", 0.025687040761113167, 1.0, 0.007483768276870251, 0.023943811655044556, 0.004429688211530447, 0.0020409829448908567, 0.02957707643508911, 0.022492941468954086, 0.0157569982111454, 0.006598545704036951, 0.028065131977200508, 0.02624683640897274, 0.018264364451169968, 0.003234490053728223, 0.023445168510079384, 0.028114140033721924, 0.02927577495574951, 0.0060982005670666695, 0.00501358462497592, 0.029629847034811974, 0.019420644268393517, 0.00247594085521996, 0.006339321378618479, 0.005351636558771133, 0.001000738819129765, 0.02263301983475685, 0.0008047068840824068, 0.011051645502448082, 0.026182131841778755, 0.009976666420698166], [\"ENSG00000234531\", \"ENSG00000234531\", \"black\", 0.02694907784461975, 0.027676744386553764, 0.0075879222713410854, 0.025976963341236115, 0.004463933873921633, 0.0013728711055591702, 0.022432049736380577, 0.0250238124281168, 0.017466753721237183, 0.00658737076446414, 0.0234923604875803, 0.02312091924250126, 0.01613883674144745, 0.0016403078334406018, 0.022129451856017113, 0.021798623725771904, 0.021939685568213463, 0.005094352178275585, 0.004861684050410986, 0.02308453433215618, 0.02345755137503147, 0.0014176667900756001, 0.008290589787065983, 0.003398682689294219, 0.0011225893395021558, 0.02116059511899948, 0.0010613686172291636, 0.011185402050614357, 0.01854904554784298, 0.0069786193780601025], [\"GALNT15\", \"ENSG00000131386\", \"black\", 0.02879427932202816, 0.023943811655044556, 0.009009561501443386, 1.0, 0.0051169805228710175, 0.0008638509316369891, 0.020532239228487015, 0.023323724046349525, 0.018774406984448433, 0.006558761466294527, 0.02395596355199814, 0.021586155518889427, 0.012724828906357288, 0.0008401742670685053, 0.025316443294286728, 0.021405771374702454, 0.023570101708173752, 0.006059426814317703, 0.005271253641694784, 0.022199353203177452, 0.027454471215605736, 0.0005692834965884686, 0.012885406613349915, 0.0026991504710167646, 0.0012368080206215382, 0.022842833772301674, 0.0008466109866276383, 0.011653473600745201, 0.01419095229357481, 0.004999611526727676], [\"RP11-208G20.3\", \"ENSG00000270405\", \"black\", 0.025571981444954872, 0.02145686000585556, 0.008321776986122131, 0.023885715752840042, 0.00521918386220932, 0.0009071534732356668, 0.019221600145101547, 0.01829192228615284, 0.01769404113292694, 0.004662211984395981, 0.019005030393600464, 0.018946370109915733, 0.012668509036302567, 0.0005404310650192201, 0.018619144335389137, 0.016026612371206284, 0.0170726478099823, 0.009893184527754784, 0.007346983999013901, 0.017666509374976158, 0.019039422273635864, 0.0007082069059833884, 0.008571963757276535, 0.0022568553686141968, 0.0008902070112526417, 0.015250355005264282, 0.0008997145341709256, 0.014216705225408077, 0.01331296656280756, 0.005012494046241045], [\"CTD-2193P3.2\", \"ENSG00000249772\", \"black\", 0.01734722964465618, 0.016828114166855812, 0.008317960426211357, 0.019513098523020744, 0.003741820575669408, 0.0018715017940849066, 0.013656864874064922, 0.015887852758169174, 0.012731848284602165, 0.007021049503237009, 0.015216384083032608, 0.013979561626911163, 0.012404303066432476, 0.0010405398206785321, 0.020917560905218124, 0.01493202243000269, 0.014436683617532253, 0.009794296696782112, 0.005852727219462395, 0.015412633307278156, 0.013997300527989864, 0.0008473745547235012, 0.0069770487025380135, 0.0026471372693777084, 0.001361218630336225, 0.01484011486172676, 0.0017268942901864648, 0.015077265910804272, 0.01190122589468956, 0.005080054979771376], [\"MORC3\", \"ENSG00000159256\", \"black\", 0.03078741766512394, 0.02957707643508911, 0.006544962991029024, 0.020532239228487015, 0.0053050322458148, 0.0018873404478654265, 1.0, 0.014810344204306602, 0.0161086805164814, 0.005871774163097143, 0.02492176555097103, 0.019997650757431984, 0.015555905178189278, 0.0020519753452390432, 0.020270776003599167, 0.0217434074729681, 0.019354872405529022, 0.005471095908433199, 0.006300531793385744, 0.021669702604413033, 0.020103223621845245, 0.002791750244796276, 0.004783167969435453, 0.006353931967169046, 0.0006677964120171964, 0.020402325317263603, 0.0006546119111590087, 0.009673146530985832, 0.021776383742690086, 0.012852541171014309], [\"H2AFX\", \"ENSG00000188486\", \"black\", 0.025316674262285233, 0.022492941468954086, 0.008786095306277275, 0.023323724046349525, 0.0026264593470841646, 0.0010213620262220502, 0.014810344204306602, 1.0, 0.020568059757351875, 0.006317521911114454, 0.017539242282509804, 0.021803591400384903, 0.012112051248550415, 0.0007208164897747338, 0.014638250693678856, 0.01539675798267126, 0.0153951495885849, 0.005825212690979242, 0.006066922564059496, 0.015484965406358242, 0.02260180003941059, 0.0009264490799978375, 0.011717187240719795, 0.002114374889060855, 0.0009129594545811415, 0.013024339452385902, 0.0009313306654803455, 0.008698643185198307, 0.016912410035729408, 0.0038816549349576235], [\"JOSD1\", \"ENSG00000100221\", \"black\", 0.026060927659273148, 0.0157569982111454, 0.0070524574257433414, 0.018774406984448433, 0.005806672852486372, 0.0012481162557378411, 0.0161086805164814, 0.020568059757351875, 1.0, 0.004381935112178326, 0.016445331275463104, 0.014913261868059635, 0.011004101485013962, 0.000378751487005502, 0.011198540218174458, 0.012008399702608585, 0.010530687868595123, 0.009790653362870216, 0.008927369490265846, 0.012378647923469543, 0.016092920675873756, 0.0008879423257894814, 0.010250427760183811, 0.00302947498857975, 0.0008824774995446205, 0.010573944076895714, 0.0015893770614638925, 0.010249335318803787, 0.015736732631921768, 0.00477939285337925], [\"RP11-14N4.1\", \"ENSG00000271468\", \"black\", 0.024890070781111717, 0.02425944246351719, 0.006220581941306591, 0.020979326218366623, 0.0035342497285455465, 0.0009882345329970121, 0.01620231755077839, 0.02430913597345352, 0.014570282772183418, 0.0058647580444812775, 0.017743131145834923, 0.01950937882065773, 0.012524313293397427, 0.0011318684555590153, 0.016440484672784805, 0.019236808642745018, 0.016348285600543022, 0.006539933383464813, 0.006597236264497042, 0.018566887825727463, 0.015817658975720406, 0.0006674264441244304, 0.010681590996682644, 0.002386049134656787, 0.0012677529593929648, 0.014244639314711094, 0.0008224235498346388, 0.010097436606884003, 0.014433191157877445, 0.005373927764594555], [\"BRCA1\", \"ENSG00000012048\", \"black\", 0.03298395127058029, 0.028065131977200508, 0.0062448796816170216, 0.02395596355199814, 0.004151421133428812, 0.0010041099740192294, 0.02492176555097103, 0.017539242282509804, 0.016445331275463104, 0.004986126441508532, 1.0, 0.01909768395125866, 0.01287049986422062, 0.001403965288773179, 0.018955135717988014, 0.019718103110790253, 0.019475260749459267, 0.005901149939745665, 0.005022712051868439, 0.02040204219520092, 0.01948513649404049, 0.001095681800507009, 0.0072279334999620914, 0.002928274217993021, 0.000904943619389087, 0.021588260307908058, 0.0008300476474687457, 0.0090726837515831, 0.015662159770727158, 0.006782221607863903], [\"ZNF337\", \"ENSG00000130684\", \"black\", 0.025317203253507614, 0.02624683640897274, 0.00814109854400158, 0.021586155518889427, 0.0037593264132738113, 0.001238395576365292, 0.019997650757431984, 0.021803591400384903, 0.014913261868059635, 0.006155587267130613, 0.01909768395125866, 1.0, 0.012828875333070755, 0.0010170933092013001, 0.016897737979888916, 0.01575586386024952, 0.017248759046196938, 0.005270972847938538, 0.0059392256662249565, 0.018343517556786537, 0.020462969318032265, 0.0010097580961883068, 0.00606883317232132, 0.002624050946906209, 0.0009318243246525526, 0.015645068138837814, 0.0007308470085263252, 0.009902085177600384, 0.01630154624581337, 0.006192118860781193], [\"CCDC171\", \"ENSG00000164989\", \"black\", 0.015101919881999493, 0.018264364451169968, 0.008478691801428795, 0.012724828906357288, 0.0056767649948596954, 0.004097258672118187, 0.015555905178189278, 0.012112051248550415, 0.011004101485013962, 0.008734142407774925, 0.01287049986422062, 0.012828875333070755, 1.0, 0.0013921927893534303, 0.012334204278886318, 0.012950770556926727, 0.013220812194049358, 0.00719413161277771, 0.0062255957163870335, 0.014228723011910915, 0.011826347559690475, 0.002793374937027693, 0.003455400699749589, 0.005250040907412767, 0.0010836560977622867, 0.012588409706950188, 0.0016924813389778137, 0.01014048233628273, 0.014110082760453224, 0.008335672318935394], [\"TCEA1P2\", \"ENSG00000230409\", \"black\", 0.024407224729657173, 0.023091996088624, 0.0061336602084338665, 0.017719479277729988, 0.0044401283375918865, 0.0011032001348212361, 0.017839523032307625, 0.014590143226087093, 0.013349298387765884, 0.0044470978900790215, 0.018015429377555847, 0.015455069951713085, 0.012020690366625786, 0.0011268854141235352, 0.01715189963579178, 0.01704435981810093, 0.017064783722162247, 0.007855374366044998, 0.005675989668816328, 0.01834098808467388, 0.01361725851893425, 0.0008684773347340524, 0.006531016901135445, 0.0024640015326440334, 0.0010699204867705703, 0.016095807775855064, 0.0009967024670913815, 0.011548396199941635, 0.012082239612936974, 0.005831809248775244], [\"OR9A2\", \"ENSG00000179468\", \"black\", 0.023385992273688316, 0.023445168510079384, 0.006016986910253763, 0.025316443294286728, 0.004783258307725191, 0.001323903794400394, 0.020270776003599167, 0.014638250693678856, 0.011198540218174458, 0.005658883135765791, 0.018955135717988014, 0.016897737979888916, 0.012334204278886318, 0.0016319321002811193, 1.0, 0.02070506289601326, 0.01911025680601597, 0.0064340876415371895, 0.00515559921041131, 0.02389051765203476, 0.017856033518910408, 0.0006359826656989753, 0.006208433303982019, 0.0027399647515267134, 0.001449098694138229, 0.022601287811994553, 0.0009757059742696583, 0.013688603416085243, 0.011751994490623474, 0.005316540133208036], [\"MEIS1\", \"ENSG00000143995\", \"black\", 0.025865348055958748, 0.028114140033721924, 0.004204906988888979, 0.021405771374702454, 0.004573407117277384, 0.0012302588438615203, 0.0217434074729681, 0.01539675798267126, 0.012008399702608585, 0.004698446951806545, 0.019718103110790253, 0.01575586386024952, 0.012950770556926727, 0.0029556667432188988, 0.02070506289601326, 1.0, 0.01920824870467186, 0.004978191573172808, 0.0052059246227145195, 0.021045923233032227, 0.013441531918942928, 0.0010245576268061996, 0.009801473468542099, 0.0036492145154625177, 0.0018351373728364706, 0.01934773288667202, 0.0007009204709902406, 0.011745351366698742, 0.017389539629220963, 0.008519756607711315], [\"OTUD7A\", \"ENSG00000169918\", \"black\", 0.022621192038059235, 0.02927577495574951, 0.006708244793117046, 0.023570101708173752, 0.003954087384045124, 0.0016283862059935927, 0.019354872405529022, 0.0153951495885849, 0.010530687868595123, 0.0057222661562263966, 0.019475260749459267, 0.017248759046196938, 0.013220812194049358, 0.001735037425532937, 0.01911025680601597, 0.01920824870467186, 1.0, 0.004592449404299259, 0.003694483544677496, 0.02076624520123005, 0.014977559447288513, 0.001055230270139873, 0.006686032749712467, 0.002561292378231883, 0.001180698280222714, 0.01979665458202362, 0.0007579459343105555, 0.009585498832166195, 0.012609097175300121, 0.005161448381841183], [\"RP11-640B6.1\", \"ENSG00000248466\", \"black\", 0.02772148884832859, 0.02495507337152958, 0.005241375882178545, 0.020338332280516624, 0.004837942775338888, 0.0009480816079303622, 0.02330179512500763, 0.015064475126564503, 0.015557586215436459, 0.004372813273221254, 0.02141054905951023, 0.01529624406248331, 0.013281191699206829, 0.0014040871756151319, 0.017549067735671997, 0.01943107694387436, 0.016118071973323822, 0.006553479004651308, 0.005144350230693817, 0.019139839336276054, 0.014957113191485405, 0.000979687087237835, 0.006956798955798149, 0.003237341996282339, 0.0011216944549232721, 0.01755812205374241, 0.0009939436567947268, 0.009077790193259716, 0.014186384156346321, 0.006925360765308142], [\"SMARCE1P1\", \"ENSG00000225215\", \"black\", 0.026348484680056572, 0.026009107008576393, 0.0064919451251626015, 0.02275586500763893, 0.0040463344193995, 0.0011983260046690702, 0.020956888794898987, 0.018482044339179993, 0.013695333153009415, 0.0049865469336509705, 0.019635150209069252, 0.01685410737991333, 0.014530524611473083, 0.0012168872635811567, 0.018053673207759857, 0.018184423446655273, 0.019359545782208443, 0.005200871732085943, 0.0041784304194152355, 0.01769890822470188, 0.01727212406694889, 0.0008073984645307064, 0.0070725311525166035, 0.003021989483386278, 0.0010738401906564832, 0.01793508604168892, 0.0008289963589049876, 0.008988926187157631, 0.012008379213511944, 0.005615966394543648], [\"NMUR2\", \"ENSG00000132911\", \"black\", 0.02548004686832428, 0.029629847034811974, 0.0046853660605847836, 0.022199353203177452, 0.005454035475850105, 0.0013160808011889458, 0.021669702604413033, 0.015484965406358242, 0.012378647923469543, 0.004308872390538454, 0.02040204219520092, 0.018343517556786537, 0.014228723011910915, 0.0013950851280242205, 0.02389051765203476, 0.021045923233032227, 0.02076624520123005, 0.0044552297331392765, 0.005102077033370733, 1.0, 0.01632014475762844, 0.000867977854795754, 0.005410171579569578, 0.002914017764851451, 0.0012540648458525538, 0.023392727598547935, 0.0005635775160044432, 0.010903875343501568, 0.013349219225347042, 0.004981524311006069], [\"RAI14\", \"ENSG00000039560\", \"black\", 0.03793855383992195, 0.019420644268393517, 0.009411565028131008, 0.027454471215605736, 0.005292474292218685, 0.0008792576263658702, 0.020103223621845245, 0.02260180003941059, 0.016092920675873756, 0.006233359687030315, 0.01948513649404049, 0.020462969318032265, 0.011826347559690475, 0.0006144358194433153, 0.017856033518910408, 0.013441531918942928, 0.014977559447288513, 0.004231419879943132, 0.006662528030574322, 0.01632014475762844, 1.0, 0.0007334501133300364, 0.00834592990577221, 0.002300266409292817, 0.0007861584890633821, 0.022204367443919182, 0.0006843237788416445, 0.008963054046034813, 0.011448130942881107, 0.0049983663484454155], [\"USP32P3\", \"ENSG00000189423\", \"black\", 0.027860889211297035, 0.025181548669934273, 0.00480085052549839, 0.018212132155895233, 0.0035238987766206264, 0.0010291201760992408, 0.02156302146613598, 0.016658678650856018, 0.014570779167115688, 0.003789322217926383, 0.02081329934298992, 0.01912192441523075, 0.011799667961895466, 0.0018814627546817064, 0.018017280846834183, 0.02136421576142311, 0.015414359979331493, 0.0057538715191185474, 0.006129881367087364, 0.019103102385997772, 0.015023947693407536, 0.0009866239270195365, 0.00793065968900919, 0.0027368732262402773, 0.0010504729580134153, 0.016359291970729828, 0.0007606442668475211, 0.010412647388875484, 0.015310890972614288, 0.006980588659644127], [\"RPS14P8\", \"ENSG00000239528\", \"black\", 0.02013300359249115, 0.02047022432088852, 0.006576509214937687, 0.020795106887817383, 0.004137320443987846, 0.0011723263887688518, 0.015304949134588242, 0.017509130761027336, 0.014416840858757496, 0.00525720464065671, 0.015532701276242733, 0.01539530698210001, 0.014227056875824928, 0.000917317345738411, 0.014279567636549473, 0.016305968165397644, 0.015395065769553185, 0.006369346287101507, 0.004209539853036404, 0.013823717832565308, 0.013656333088874817, 0.0006825472810305655, 0.007521297316998243, 0.0022613746114075184, 0.001186539651826024, 0.012249024584889412, 0.0008671795367263258, 0.010314568877220154, 0.011041938327252865, 0.004311466123908758], [\"AC092835.2\", \"ENSG00000233757\", \"black\", 0.029480410739779472, 0.02081926167011261, 0.005991061218082905, 0.017933828756213188, 0.004214944783598185, 0.000985994003713131, 0.02124527469277382, 0.01425180584192276, 0.015084060840308666, 0.004252173006534576, 0.01989644765853882, 0.014945769682526588, 0.011193260550498962, 0.0010878361063078046, 0.015452543273568153, 0.014507152140140533, 0.01549517922103405, 0.006340468302369118, 0.004634293727576733, 0.014424019493162632, 0.016114333644509315, 0.0008886201540008187, 0.006072644609957933, 0.002954724710434675, 0.0009161254856735468, 0.01713196188211441, 0.0011358916526660323, 0.008178465999662876, 0.013047249056398869, 0.006226361263543367], [\"FAM179B\", \"ENSG00000198718\", \"black\", 0.015889586880803108, 0.021598944440484047, 0.004922472406178713, 0.014136341400444508, 0.0033022863790392876, 0.0022110436111688614, 0.014858441427350044, 0.01375230960547924, 0.010531158186495304, 0.004893010016530752, 0.014592540450394154, 0.013507849536836147, 0.014502383768558502, 0.0022449633106589317, 0.016385065391659737, 0.017498400062322617, 0.015138218179345131, 0.006625110283493996, 0.004514683969318867, 0.01675562933087349, 0.009502644650638103, 0.0011055240174755454, 0.00570308230817318, 0.0034845194313675165, 0.0020206847693771124, 0.01381209772080183, 0.001485041226260364, 0.011581573635339737, 0.013434263877570629, 0.005222472827881575], [\"MAN2A1\", \"ENSG00000112893\", \"black\", 0.03232298046350479, 0.02263301983475685, 0.005541628692299128, 0.022842833772301674, 0.00546675268560648, 0.0010698129190132022, 0.020402325317263603, 0.013024339452385902, 0.010573944076895714, 0.0051807560957968235, 0.021588260307908058, 0.015645068138837814, 0.012588409706950188, 0.0014136952813714743, 0.022601287811994553, 0.01934773288667202, 0.01979665458202362, 0.00431947922334075, 0.0040595452301204205, 0.023392727598547935, 0.022204367443919182, 0.0005604483303613961, 0.007435144390910864, 0.002779692877084017, 0.0021342369727790356, 1.0, 0.0007819769671186805, 0.009752445854246616, 0.009963450953364372, 0.00473950756713748], [\"RP11-214N15.5\", \"ENSG00000234017\", \"black\", 0.02302376553416252, 0.01971534825861454, 0.006888427771627903, 0.02198496274650097, 0.004277289845049381, 0.0009009794448502362, 0.015509851276874542, 0.016886232420802116, 0.01615382730960846, 0.004308789502829313, 0.016435569152235985, 0.01664987951517105, 0.01122952252626419, 0.00048722323845140636, 0.01673716865479946, 0.012995995581150055, 0.014826998114585876, 0.007076576352119446, 0.006475772708654404, 0.016253234818577766, 0.016146378591656685, 0.0006251148297451437, 0.006372004747390747, 0.002025237074121833, 0.0008846837445162237, 0.01314712967723608, 0.000833531201351434, 0.011162668466567993, 0.010854925960302353, 0.003722648834809661], [\"RP11-1081K18.1\", \"ENSG00000253697\", \"black\", 0.01565227098762989, 0.011716811917722225, 0.009243452921509743, 0.013928950764238834, 0.0037995821330696344, 0.0020671607926487923, 0.011095749214291573, 0.013308508321642876, 0.013513362966477871, 0.005127974785864353, 0.01058591715991497, 0.013598727993667126, 0.01255739014595747, 0.0004003308422397822, 0.010158225893974304, 0.007906847633421421, 0.009781570173799992, 0.00940051767975092, 0.0057744053192436695, 0.008074725046753883, 0.012386687099933624, 0.0009663450764492154, 0.004855068866163492, 0.002807934768497944, 0.0007800117018632591, 0.008433977141976357, 0.0014801202341914177, 0.011974813416600227, 0.009417776018381119, 0.00460587814450264], [\"TRADD\", \"ENSG00000102871\", \"black\", 0.020415619015693665, 0.026182131841778755, 0.005269222892820835, 0.01419095229357481, 0.003717549378052354, 0.0025299747940152884, 0.021776383742690086, 0.016912410035729408, 0.015736732631921768, 0.005411799997091293, 0.015662159770727158, 0.01630154624581337, 0.014110082760453224, 0.001992309233173728, 0.011751994490623474, 0.017389539629220963, 0.012609097175300121, 0.006316240876913071, 0.0057531180791556835, 0.013349219225347042, 0.011448130942881107, 0.0028627626597881317, 0.003943387418985367, 0.0053955866023898125, 0.0007271232316270471, 0.009963450953364372, 0.000993766007013619, 0.00846746377646923, 1.0, 0.009254182688891888], [\"SNORA70\", \"ENSG00000253042\", \"black\", 0.019029950723052025, 0.01782894879579544, 0.005540220532566309, 0.019954437389969826, 0.00330357626080513, 0.0009922286262735724, 0.013917651027441025, 0.018032077699899673, 0.015411628410220146, 0.0032831807620823383, 0.014306755736470222, 0.015290900133550167, 0.010810659267008305, 0.0006742016994394362, 0.012772956863045692, 0.013060267083346844, 0.013621324673295021, 0.007213224656879902, 0.004393863026052713, 0.012572101317346096, 0.012838348746299744, 0.0010498869232833385, 0.006686181761324406, 0.001755054690875113, 0.0006397271063178778, 0.00956031121313572, 0.0008852761820890009, 0.012102236039936543, 0.01119046937674284, 0.0036901107523590326]]}";
            return response;
        }

        /****************************************************************************/
        /******************************* POST METHODS *******************************/
        /****************************************************************************/

        [HttpPost]
        [Route("GetInfoFromQuickGO")]
        public string GetInfoFromQuickGO([FromForm]string term)
        {
            ExternalDataRepository repository = new ExternalDataRepository();
            string response = repository.GetInfoFromQuickGO(term);

            return response;
        }

        [HttpPost]
        [Route("GetInfoFromREACTOME")]
        public string GetInfoFromREACTOME([FromForm]string term)
        {
            ExternalDataRepository repository = new ExternalDataRepository();
            string response = repository.GetInfoFromREACTOME(term);

            return response;
        }

        [HttpPost]
        [Route("GetInfoFromKEGG")]
        public string GetInfoFromKEGG([FromForm]string term)
        {
            ExternalDataRepository repository = new ExternalDataRepository();
            string response = repository.GetInfoFromKEGG(term);

            return response;
        }

        [HttpPost]
        [Route("PostReportOnGenesMultipleTissue")]
        public string PostReportOnGenesMultipleTissue([FromBody] CoexpParams coexpdata)
        {
            //category = which.one
            //network = tissue
            CoExpRepository repository = new CoExpRepository(_hostingEnvironment);
            string response = repository.ReportOnGenesMultipleTissue(coexpdata);

            string parsed_response = response.Replace("go.report", "go_report");
            parsed_response = parsed_response.Replace("pd.genes", "pd_genes");
            parsed_response = parsed_response.Replace("cell.type.pred", "cell_type_pred");
            //parsed_response = parsed_response.Replace("p.val.mods", "p_val_mods");
            parsed_response = parsed_response.Replace("tissue", "network");


            return parsed_response;
        }

        [HttpPost]
        [Route("PostGlobalReportOnGenes")]
        public string PostGlobalReportOnGenes([FromBody] CoexpParams coexpdata)
        {
            //category = which.one
            //network = tissue
            CoExpRepository repository = new CoExpRepository(_hostingEnvironment);
            string response = repository.GlobalReportOnGenes(coexpdata);

            string parsed_response = response.Replace("go.report", "go_report");
            parsed_response = parsed_response.Replace("pd.genes", "pd_genes");
            parsed_response = parsed_response.Replace("cell.type.pred", "cell_type_pred");
            //parsed_response = parsed_response.Replace("p.val.mods", "p_val_mods");
            parsed_response = parsed_response.Replace("tissue", "network");


            return parsed_response;
        }
 
    }
}